{"version":3,"file":"4d48c1ab.js","sources":["../../../src/components/account/LoginForm.client.jsx"],"sourcesContent":["import React from 'react';\nimport {useNavigate, Link} from '@shopify/hydrogen/client';\n\nexport default function LoginForm({shopName}) {\n  const navigate = useNavigate();\n  const [hasSubmitError, setHasSubmitError] = React.useState(false);\n  const [showEmailField, setShowEmailField] = React.useState(true);\n\n  const [email, setEmail] = React.useState('');\n  const [emailError, setEmailError] = React.useState(null);\n\n  const [password, setPassword] = React.useState('');\n  const [passwordError, setPasswordError] = React.useState(null);\n\n  function onSubmit(event) {\n    event.preventDefault();\n\n    setEmailError(null);\n    setHasSubmitError(false);\n    setPasswordError(null);\n\n    if (showEmailField) {\n      checkEmail(event);\n    } else {\n      checkPassword(event);\n    }\n  }\n\n  function checkEmail(event) {\n    if (event.target.email.validity.valid) {\n      setShowEmailField(false);\n    } else {\n      setEmailError('Please enter a valid email');\n    }\n  }\n\n  async function checkPassword(event) {\n    const validity = event.target.password.validity;\n    if (validity.valid) {\n      const response = await callLoginApi({\n        email,\n        password,\n      });\n\n      if (response.error) {\n        setHasSubmitError(true);\n        resetForm();\n      } else {\n        navigate('/account');\n      }\n    } else {\n      setPasswordError(\n        validity.valueMissing\n          ? 'Please enter a password'\n          : 'Passwords must be at least 6 characters',\n      );\n    }\n  }\n\n  function resetForm() {\n    setShowEmailField(true);\n    setEmail('');\n    setEmailError(null);\n    setPassword('');\n    setPasswordError(null);\n  }\n\n  return (\n    <div className=\"flex justify-center\">\n      <div className=\"max-w-md w-full\">\n        <h1 className=\"text-4xl\">Sign in.</h1>\n        <form noValidate className=\"pt-6 pb-8 mt-4 mb-4\" onSubmit={onSubmit}>\n          {hasSubmitError && (\n            <div className=\"flex items-center justify-center mb-6 bg-zinc-500\">\n              <p className=\"m-4 text-s text-white\">\n                Sorry we did not recognize either your email or password. Please\n                try to sign in again or create a new account.\n              </p>\n            </div>\n          )}\n          {showEmailField && (\n            <EmailField\n              shopName={shopName}\n              email={email}\n              setEmail={setEmail}\n              emailError={emailError}\n            />\n          )}\n          {!showEmailField && (\n            <ValidEmail email={email} resetForm={resetForm} />\n          )}\n          {!showEmailField && (\n            <PasswordField\n              password={password}\n              setPassword={setPassword}\n              passwordError={passwordError}\n            />\n          )}\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport function callLoginApi({email, password}) {\n  return fetch(`/account/login`, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({email, password}),\n  })\n    .then((res) => {\n      if (res.ok) {\n        return {};\n      } else {\n        return res.json();\n      }\n    })\n    .catch((error) => {\n      return {\n        error: error.toString(),\n      };\n    });\n}\n\nfunction EmailField({email, setEmail, emailError, shopName}) {\n  return (\n    <>\n      <div className=\"mb-4\">\n        <input\n          className={`mb-1 appearance-none border w-full py-2 px-3 text-gray-800 placeholder:text-gray-500 leading-tight focus:shadow-outline ${\n            emailError ? ' border-red-500' : 'border-gray-900'\n          }`}\n          id=\"email\"\n          name=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          required\n          placeholder=\"Email address\"\n          aria-label=\"Email address\"\n          value={email}\n          onChange={(event) => {\n            setEmail(event.target.value);\n          }}\n        />\n        <p className={`text-red-500 text-xs ${!emailError ? 'invisible' : ''}`}>\n          {emailError} &nbsp;\n        </p>\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"bg-gray-900 text-white uppercase py-2 px-4 focus:shadow-outline block w-full\"\n          type=\"submit\"\n        >\n          Next\n        </button>\n      </div>\n      <div className=\"flex items-center mt-4\">\n        <p className=\"align-baseline text-sm\">\n          New to {shopName}? &nbsp;\n          <Link className=\"inline underline\" to=\"/account/register\">\n            Create an account\n          </Link>\n        </p>\n      </div>\n    </>\n  );\n}\n\nfunction ValidEmail({email, resetForm}) {\n  return (\n    <div className=\"mb-6 flex items-center justify-between\">\n      <div>\n        <p>{email}</p>\n        <input\n          className=\"hidden\"\n          type=\"text\"\n          autoComplete=\"username\"\n          value={email}\n          readOnly\n        ></input>\n      </div>\n      <div>\n        <button\n          className=\"inline-block align-baseline text-sm underline\"\n          type=\"button\"\n          onClick={resetForm}\n        >\n          Change email\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction PasswordField({password, setPassword, passwordError}) {\n  return (\n    <>\n      <div className=\"mb-6\">\n        <input\n          className={`mb-1 appearance-none border w-full py-2 px-3 text-gray-800 placeholder:text-gray-500 leading-tight focus:shadow-outline ${\n            passwordError ? ' border-red-500' : 'border-gray-900'\n          }`}\n          id=\"password\"\n          name=\"password\"\n          type=\"password\"\n          autoComplete=\"current-password\"\n          placeholder=\"Password\"\n          aria-label=\"Password\"\n          value={password}\n          minLength={8}\n          required\n          onChange={(event) => {\n            setPassword(event.target.value);\n          }}\n        />\n        <p\n          className={`text-red-500 text-xs ${\n            !passwordError ? 'invisible' : ''\n          }`}\n        >\n          {passwordError} &nbsp;\n        </p>\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"bg-gray-900 text-white uppercase py-2 px-4 focus:shadow-outline block w-full\"\n          type=\"submit\"\n        >\n          Sign in\n        </button>\n      </div>\n      <div className=\"flex items-center justify-between mt-4\">\n        <div className=\"flex-1\"></div>\n        <Link\n          className=\"inline-block align-baseline text-sm text-gray-500\"\n          to=\"/account/recover\"\n        >\n          Forgot password\n        </Link>\n      </div>\n    </>\n  );\n}\n"],"names":["shopName","navigate","useNavigate","hasSubmitError","setHasSubmitError","React","useState","showEmailField","setShowEmailField","email","setEmail","emailError","setEmailError","password","setPassword","passwordError","setPasswordError","event","preventDefault","checkEmail","checkPassword","target","validity","valid","response","callLoginApi","error","valueMissing","_jsx","_jsxs","fetch","method","headers","Accept","body","JSON","stringify","then","res","ok","json","catch","toString","_Fragment","value","resetForm"],"mappings":"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"}