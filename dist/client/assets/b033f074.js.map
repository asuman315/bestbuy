{"version":3,"file":"b033f074.js","sources":["../../../src/components/account/AddressBook.client.jsx"],"sourcesContent":["import {useServerProps} from '@shopify/hydrogen';\nimport {useMemo, useState} from 'react';\n\nexport default function AddressBook({addresses, defaultAddress}) {\n  const {serverProps, setServerProps} = useServerProps();\n\n  const {fullDefaultAddress, addressesWithoutDefault} = useMemo(() => {\n    const defaultAddressIndex = addresses.findIndex(\n      (address) => address.id === defaultAddress,\n    );\n    return {\n      addressesWithoutDefault: [\n        ...addresses.slice(0, defaultAddressIndex),\n        ...addresses.slice(defaultAddressIndex + 1, addresses.length),\n      ],\n      fullDefaultAddress: addresses[defaultAddressIndex],\n    };\n  }, [addresses, defaultAddress]);\n\n  async function deleteAddress(id) {\n    const response = await callDeleteAddressApi(id);\n    if (response.error) alert(response.error);\n    else setServerProps('rerender', !serverProps.rerender);\n  }\n\n  return (\n    <div className=\"mt-6\">\n      <h2 className=\"text-2xl\">Address Book</h2>\n      {!addresses?.length ? (\n        <p className=\"mt-2 text-sm text-gray-500\">No address yet</p>\n      ) : null}\n      <div className=\"flex items-center justify-between mt-2\">\n        <button\n          onClick={() => setServerProps('editingAddress', 'NEW')}\n          className=\"text-center border border-gray-900 uppercase py-3 px-4 focus:shadow-outline block w-full\"\n        >\n          Add an address\n        </button>\n      </div>\n      {addresses?.length ? (\n        <>\n          {fullDefaultAddress ? (\n            <Address\n              address={fullDefaultAddress}\n              defaultAddress\n              deleteAddress={deleteAddress.bind(\n                null,\n                fullDefaultAddress.originalId,\n              )}\n            />\n          ) : null}\n          {addressesWithoutDefault.map((address) => (\n            <Address\n              key={address.id}\n              address={address}\n              deleteAddress={deleteAddress.bind(null, address.originalId)}\n            />\n          ))}\n        </>\n      ) : null}\n    </div>\n  );\n}\n\nfunction Address({address, defaultAddress, deleteAddress}) {\n  const {setServerProps} = useServerProps();\n  const [showConfirmRemove, setShowConfirmRemove] = useState(false);\n\n  return (\n    <div className=\"bg-white p-4 mt-4\">\n      {showConfirmRemove ? (\n        <ConfirmRemove\n          deleteAddress={deleteAddress}\n          close={() => setShowConfirmRemove(false)}\n        />\n      ) : null}\n      {defaultAddress ? (\n        <p className=\"mb-2 text-sm text-gray-500 font-medium\">\n          Default Delivery Address\n        </p>\n      ) : null}\n      {address.formatted.map((line, index) => (\n        /* eslint-disable-next-line react/no-array-index-key */\n        <div className=\"pt-1\" key={line + index}>\n          {line}\n        </div>\n      ))}\n\n      <div className=\"flex font-medium mt-4\">\n        <button\n          onClick={() => setServerProps('editingAddress', address.id)}\n          className=\"text-left flex-1 underline\"\n        >\n          Edit\n        </button>\n        <button\n          onClick={() => setShowConfirmRemove(true)}\n          className=\"text-left text-gray-500\"\n        >\n          Remove\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction callDeleteAddressApi(id) {\n  return fetch(`/account/address/${encodeURIComponent(id)}`, {\n    method: 'DELETE',\n    headers: {\n      Accept: 'application/json',\n    },\n  })\n    .then((res) => {\n      if (res.ok) {\n        return {};\n      } else {\n        return res.json();\n      }\n    })\n    .catch(() => {\n      return {\n        error: 'Error removing address. Please try again.',\n      };\n    });\n}\n\nfunction ConfirmRemove({close, deleteAddress}) {\n  return (\n    <>\n      <div className=\"fixed w-full h-full bg-white opacity-95 z-50 top-0 left-0\"></div>\n      <div className=\"fixed w-full h-full z-50 top-0 left-0\">\n        <div className=\"flex justify-center mt-64 items-center\">\n          <div className=\"bg-gray-50 max-w-md w-full p-4\">\n            <div className=\"text-xl\">Confirm removal</div>\n            <div>Are you sure you wish to remove this address?</div>\n\n            <div className=\"mt-6\">\n              <button\n                onClick={() => {\n                  close();\n                  deleteAddress();\n                }}\n                className=\"bg-gray-900 border border-gray-900 text-white uppercase py-3 px-4 focus:shadow-outline block w-full\"\n              >\n                Confirm\n              </button>\n            </div>\n            <div>\n              <button\n                onClick={close}\n                className=\"mt-3 text-center border border-gray-900 uppercase py-3 px-4 focus:shadow-outline block w-full\"\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":["addresses","defaultAddress","serverProps","setServerProps","useServerProps","fullDefaultAddress","addressesWithoutDefault","useMemo","defaultAddressIndex","findIndex","address","id","slice","length","response","callDeleteAddressApi","error","alert","rerender","_jsx","_Fragment","deleteAddress","bind","originalId","map","showConfirmRemove","setShowConfirmRemove","useState","formatted","line","index","fetch","encodeURIComponent","method","headers","Accept","then","res","ok","json","catch","close"],"mappings":"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"}